<?xml version="1.0" encoding="UTF-8"?>
<sequence xmlns="http://pisa.intecs.it/mass/toolbox/xmlScript">
	<setVariable name="orderId">
		<orderId/>
	</setVariable>
	<setVariable name="userName">
		<string>mass</string>
	</setVariable>
	<setVariable name="password">
		<string>mass</string>
	</setVariable>
	<setVariable name="dbName">
		<string>mass</string>
	</setVariable>
	<setVariable name="dbHost">
		<string>localhost</string>
	</setVariable>
	<setVariable name="URL">
		<string>jdbc:mysql://localhost/mass</string>
	</setVariable>
	<setVariable name="connection">
		<dbConnect driver="com.mysql.jdbc.Driver" autoCommit="false">
			<variable name="URL"/>
			<variable name="userName"/>
			<variable name="password"/>
		</dbConnect>
	</setVariable>
	<setVariable name="errorFlag">
		<literal type="boolean" value="false"/>
	</setVariable>
	<try>
		<sequence>
			<dbUpdate>
				<variable name="connection"/>
				<string>CREATE TABLE sizes (idx INT NOT NULL, productSize INT, PRIMARY KEY(idx));</string>
			</dbUpdate>
			<setVariable name="myError">
				<string>Table sizes Created</string>
			</setVariable>
		</sequence>
		<ifError errorMessageName="myError">
			<setVariable name="errorFlag">
				<literal type="boolean" value="true"/>
			</setVariable>
		</ifError>
		<anyway>
			<sequence>
				<if>
					<variable name="errorFlag"/>
					<sequence>
						<dbRollback>
							<variable name="connection"/>
						</dbRollback>
						<log>
							<string>ROLLBACK</string>
						</log>
					</sequence>
					<sequence>
						<dbCommit>
							<variable name="connection"/>
						</dbCommit>
						<log>
							<string>COMMIT</string>
						</log>
					</sequence>
				</if>
				<log>
					<stringCat>
						<string>Message SQL: </string>
						<variable name="myError"/>
					</stringCat>
				</log>
			</sequence>
		</anyway>
	</try>
	<setVariable name="errorFlag">
		<literal type="boolean" value="false"/>
	</setVariable>
	<try>
		<sequence>
			<dbUpdate>
				<variable name="connection"/>
				<string>CREATE TABLE prices (idx INT NOT NULL, productPrice INT, PRIMARY KEY(idx));</string>
			</dbUpdate>
			<setVariable name="myError">
				<string>Table prices Created</string>
			</setVariable>
		</sequence>
		<ifError errorMessageName="myError">
			<setVariable name="errorFlag">
				<literal type="boolean" value="true"/>
			</setVariable>
		</ifError>
		<anyway>
			<sequence>
				<if>
					<variable name="errorFlag"/>
					<sequence>
						<dbRollback>
							<variable name="connection"/>
						</dbRollback>
						<log>
							<string>ROLLBACK</string>
						</log>
					</sequence>
					<sequence>
						<dbCommit>
							<variable name="connection"/>
						</dbCommit>
						<log>
							<string>COMMIT</string>
						</log>
					</sequence>
				</if>
				<log>
					<stringCat>
						<string>Message SQL: </string>
						<variable name="myError"/>
					</stringCat>
				</log>
			</sequence>
		</anyway>
	</try>
	<setVariable name="sqlCommnad">
		<string>insert into sizes values (1, 21534);</string>
	</setVariable>
	<setVariable name="errorFlag">
		<literal type="boolean" value="false"/>
	</setVariable>
	<try>
		<sequence>
			<dbUpdate>
				<variable name="connection"/>
				<variable name="sqlCommnad"/>
			</dbUpdate>
			<setVariable name="myError">
				<string>Table prices Created</string>
			</setVariable>
		</sequence>
		<ifError errorMessageName="myError">
			<setVariable name="errorFlag">
				<literal type="boolean" value="true"/>
			</setVariable>
		</ifError>
		<anyway>
			<sequence>
				<if>
					<variable name="errorFlag"/>
					<sequence>
						<dbRollback>
							<variable name="connection"/>
						</dbRollback>
						<log>
							<string>ROLLBACK</string>
						</log>
					</sequence>
					<sequence>
						<dbCommit>
							<variable name="connection"/>
						</dbCommit>
						<log>
							<string>COMMIT</string>
						</log>
					</sequence>
				</if>
				<log>
					<stringCat>
						<string>Message SQL: </string>
						<variable name="myError"/>
					</stringCat>
				</log>
			</sequence>
		</anyway>
	</try>
	<setVariable name="sqlCommnad">
		<string>insert into prices values (1, 370);</string>
	</setVariable>
	<setVariable name="errorFlag">
		<literal type="boolean" value="false"/>
	</setVariable>
	<try>
		<sequence>
			<dbUpdate>
				<variable name="connection"/>
				<variable name="sqlCommnad"/>
			</dbUpdate>
			<setVariable name="myError">
				<string>Table prices Created</string>
			</setVariable>
		</sequence>
		<ifError errorMessageName="myError">
			<setVariable name="errorFlag">
				<literal type="boolean" value="true"/>
			</setVariable>
		</ifError>
		<anyway>
			<sequence>
				<if>
					<variable name="errorFlag"/>
					<sequence>
						<dbRollback>
							<variable name="connection"/>
						</dbRollback>
						<log>
							<string>ROLLBACK</string>
						</log>
					</sequence>
					<sequence>
						<dbCommit>
							<variable name="connection"/>
						</dbCommit>
						<log>
							<string>COMMIT</string>
						</log>
					</sequence>
				</if>
				<log>
					<stringCat>
						<string>Message SQL: </string>
						<variable name="myError"/>
					</stringCat>
				</log>
			</sequence>
		</anyway>
	</try>
	<setVariable name="sqlQuery">
		<string>select productPrice, productSize from prices AS A, sizes AS B where  A.idx = B.idx;</string>
	</setVariable>
	<setVariable name="sqlResult">
		<dbQuery>
			<variable name="connection"/>
			<variable name="sqlQuery"/>
		</dbQuery>
	</setVariable>
	<setVariable name="ColumnName">
		<dbGetColumnName>
			<variable name="sqlResult"/>
			<literal value="2"/>
		</dbGetColumnName>
	</setVariable>
	<setVariable name="ColumnIndex">
		<dbGetColumnIndex>
			<variable name="sqlResult"/>
			<string>productPrice</string>
		</dbGetColumnIndex>
	</setVariable>
	<setVariable name="NumberOfColumn">
		<dbGetColumnCount>
			<variable name="sqlResult"/>
		</dbGetColumnCount>
	</setVariable>
	<log>
		<stringCat>
			<string>Number Of COLUMN: </string>
			<variable name="NumberOfColumn"/>
		</stringCat>
	</log>
	<log>
		<stringCat>
			<string>Index of productPrice COLUMN: </string>
			<variable name="ColumnIndex"/>
		</stringCat>
	</log>
	<log>
		<stringCat>
			<string>Name of 2 COLUMN: </string>
			<variable name="ColumnName"/>
		</stringCat>
	</log>
	<dbNextRow>
		<variable name="sqlResult"/>
	</dbNextRow>
	<setVariable name="size">
		<dbGetValue>
			<variable name="sqlResult"/>
			<string>productSize</string>
		</dbGetValue>
	</setVariable>
	<setVariable name="price">
		<dbGetValue>
			<variable name="sqlResult"/>
			<string>productPrice</string>
		</dbGetValue>
	</setVariable>
	<log>
		<stringCat>
			<string>PRICE: </string>
			<variable name="price"/>
		</stringCat>
	</log>
	<log>
		<stringCat>
			<string>SIZE: </string>
			<variable name="size"/>
		</stringCat>
	</log>
	<dbClose>
		<variable name="connection"/>
	</dbClose>
	<xmlGetResponse>
		<xmlDocument xmlns="http://pisa.intecs.it/mass/toolbox/xmlScript">
			<mass:getRFQOutput xmlns:mass="http://www.esa.int/mass">
				<mass:statusInfo>
					<mass:statusId>0</mass:statusId>
					<mass:statusMsg>Successful</mass:statusMsg>
				</mass:statusInfo>
				<mass:rfqOutput>
					<mass:productSize><text><variable name="size"/></text></mass:productSize>
					<mass:userQuota>120460</mass:userQuota>
				</mass:rfqOutput>
			</mass:getRFQOutput>
		</xmlDocument>
	</xmlGetResponse>
</sequence>
