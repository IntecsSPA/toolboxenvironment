<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <script type="text/javascript">
    var itemId="0";

        function testSubmit(){
            var json={"downloadUrl":"http://ergo.pisa.intecs.it/geotiff.tiff",
                      //"downloadUrl":"http://ergo.pisa.intecs.it/cities.zip",
                      //"downloadUrl":"http://genesis.pisa.intecs.it/genesisMetadata/poly_aq_2006-01-02.xml",//ftp://fanciulli:200753@192.168.24.53/homes/fanciulli/commons-net-2.0.tar.bz2",
                      //"metadataUrl":"http://genesis.pisa.intecs.it/ERGO_CMPL_TEST/urn-ogc-def-EOP-ESA-EECF-SPOT_ESA_MULTI-SP4-99123009560121-902-HIM.xml",
                      "deleteAfter":"60000",
                      "publish":{
                                 //"publishCatalogue":["http://localhost:8080/ergorr/webservice"],
                                 //"publishFtp":["ftp://fanciulli:200753@192.168.24.53:21/homes/fanciulli/pippo.xml","ftp://fanciulli:200753@192.168.24.53:21/homes/fanciulli/pluto.xml","ftp://fanciulli:200753@192.168.24.53:21/homes/fanciulli/paperino.xml"],
                                 "publishGeoServer":["http://admin:geoserver@192.168.31.5:8023/geoserver"] }};
            var request=new XMLHttpRequest();

            request.open("POST", 'service/store');
            request.setRequestHeader('Accept','application/json');
            request.setRequestHeader('Cache-Control','no-cache');
            request.send(JSON.stringify(json));
            request.onreadystatechange=function() {
        if(request.readyState == 4) {
            if(request.status!=200){


                Ext.Msg.show({
                    title:'Error',
                    msg: 'An error occurred while reloading settings',
                    buttons: Ext.Msg.OK,
                    animEl: 'elId',
                    icon: Ext.MessageBox.INFO
                });}
            else {
                var json = JSON.parse(request.responseText);
                itemId=json.id;

            }
        }
    }
           
        }

        function testDelete(){
            var json={"id":itemId};

            var request=new XMLHttpRequest();

            request.open("DELETE", 'service/delete');
            request.setRequestHeader('Accept','application/json');
            request.setRequestHeader('Cache-Control','no-cache');
            request.send(JSON.stringify(json));
            return request.responseBody;
        }


         function testGetStatus(){
           var request=new XMLHttpRequest();

            request.open("GET", 'service/getstatus?id='+itemId);
            request.setRequestHeader('Accept','application/json');
            request.setRequestHeader('Cache-Control','no-cache');
            request.send();
            request.onreadystatechange=function() {
        if(request.readyState == 4) {
            if(request.status!=200){


                Ext.Msg.show({
                    title:'Error',
                    msg: 'An error occurred while reloading settings',
                    buttons: Ext.Msg.OK,
                    animEl: 'elId',
                    icon: Ext.MessageBox.INFO
                });}
            else {
                document.getElementById("txtArea").value=request.responseText;
            }
        }
    }

        }

        function testReverseId(){
           var request=new XMLHttpRequest();
           var url="service/reverseid?type=cat&url="+escape("http://localhost:8080/ergorr/webservice")+"&rimid="+escape("urn:urn:ogc:def:EOP:ESA.EECF.SPOT:ESA:MULTI:SP4-99123009560121-902.HIM:pkg");

            request.open("GET", url);
            request.setRequestHeader('Accept','application/json');
            request.setRequestHeader('Cache-Control','no-cache');
            request.send();
            request.onreadystatechange=function() {
        if(request.readyState == 4) {
            if(request.status!=200){


                Ext.Msg.show({
                    title:'Error',
                    msg: 'An error occurred while reloading settings',
                    buttons: Ext.Msg.OK,
                    animEl: 'elId',
                    icon: Ext.MessageBox.INFO
                });}
            else {
                document.getElementById("txtArea").value=request.responseText;
            }
        }
    }

        }

    </script>
  </head>
  <body>
     <button onclick="javascript:testSubmit()" >Test Submit</button><br>
     <button onclick="javascript:testDelete()" >Test Delete</button><br>
     <button onclick="javascript:testGetStatus()" >Test Get Status</button><br>
     <button onclick="javascript:testReverseId()" >Test Reverse Id</button><br>
     <textarea id="txtArea" cols="80" rows="30"></textarea>
  </body>
</html>
